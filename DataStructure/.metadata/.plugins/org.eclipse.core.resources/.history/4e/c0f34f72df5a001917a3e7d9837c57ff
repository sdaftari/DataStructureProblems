package Hard;

public class ModifyLinkedList {
	
	ListNode front, back;
    public ListNode modify(ListNode head)
    {
        if (head == null || head.next == null)
            return head;
        
        frontAndBackSplit(head, front, back);
        
        // reverse the 2nd(back) list 
        reverseList(back); 
        
        // modify the contents of 1st half     
        modifyTheContentsOf1stHalf(front, back); 
        
        // agains reverse the 2nd(back) list 
        reverseList(back); 
          
        // concatenating the 2nd list back to the end of the 1st list 
        head = concatFrontAndBackList(front, back); 
          
        // pointer to the modified list 
        return head; 
    }
    
    // perfrom the required subtraction operation on 
    // the 1st half of the linked list 
    void modifyTheContentsOf1stHalf(ListNode front, ListNode back) 
    { 
        // traversing both the lists simultaneously 
        while (back != null) 
        { 
            // subtraction operation and node data 
            // modification 
            front.data = front.data - back.data; 
              
            front = front.next; 
            back = back.next; 
        } 
    } 
      
    // function to concatenate the 2nd(back) list at the end of 
    // the 1st(front) list and returns the head of the new list 
    ListNode concatFrontAndBackList(ListNode front, ListNode back) 
    { 
        Node head = front; 
          
        while (front.next != null) 
            front = front.next;     
              
        front.next = back; 
          
        return head; 
    } 
    
    /* Function to reverse the linked list */
    void reverseList(ListNode head) 
    { 
        Node current, prev, next; 
        current = head; 
        prev = null; 
        while (current != null) 
        { 
            next = current.next; 
            current.next = prev; 
            prev = current; 
            current = next; 
        }     
        head = prev; 
    } 
    
    void frontAndBackSplit(ListNode head)
    {
    	ListNode slow, fast; 
      
        slow = head; 
        fast = head.next; 
          
        /* Advance 'fast' two nodes, and  
           advance 'slow' one node */
        while (fast != null) 
        { 
            fast = fast.next; 
            if (fast != null) 
            { 
                slow = slow.next; 
                fast = fast.next; 
            } 
        } 
          
         /* 'slow' is before the midpoint in the list,  
            so split it in two at that point. */
        front = head; 
        back = slow.next; 
        slow.next = null; 
    }

	public static void main(String[] args) {
		// TODO Auto-generated method stub

	}

}
